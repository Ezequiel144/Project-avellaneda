---
import Layout from "../../layouts/Layout.astro";
import listBusinesses from "../../data/business.data.json";
import type { Business } from "../../interface";
import PerfilUser from "../../components/UserId/PerfilUser/PerfilUser.astro";

export function getStaticPaths() {
  return listBusinesses.map((item: Business) => {
    return {
      params: { id: item.title },
      props: { _id: item.id },
    };
  });
}

const { _id } = Astro.props;
const currentBusiness = listBusinesses
  ? listBusinesses.find((item: Business) => item.id === _id)
  : null;

//console.log(currentBusiness ? currentBusiness.title : "Business not found");
---

<Layout>
  {
    currentBusiness ? (
      <section class="size-full flex flex-col gap-y-9">
        <article class="h-[590px] w-full">
          <img
            src={`../image/${currentBusiness.frontpage}`}
            alt="imagen-front"
            class="size-full object-cover -z-10"
            onerror="this.onerror=null; this.src='/image/no-image.png';"
          />
        </article>
        <PerfilUser
          imageLogo={currentBusiness.imageLogo}
          title={currentBusiness.title}
          tags={currentBusiness.tags}
          socialMedia={currentBusiness.socialMedia}
          galery={currentBusiness.galery}
        />
        <article class="mx-auto w-full max-w-[1200px] flex flex-col gap-y-9">
          <div class="w-full">
            <p>{currentBusiness.longDescription}</p>
          </div>
          <div class={`flex gap-4`}>
            {currentBusiness.links.map((item) => (
              <a
                href={item.link}
                class=" w-1/3 rounded-xl bg-red-500 text-white text-center font-semibold px-4 py-3"
              >
                {item.title}
              </a>
            ))}
          </div>
        </article>
      </section>
    ) : (
      <h1>Business not found</h1>
    )
  }
</Layout>
